# HeyGen Avatar Example

This example demonstrates how to use the HeyGen plugin to add realistic avatar video to your AI agent.

## Setup

1. **Install dependencies:**

```bash
cd plugins/heygen/example
uv pip install -e .
```

2. **Configure environment variables:**

Copy `.env.example` to `.env` and fill in your API keys:

```bash
cp .env.example .env
```

Required API keys:
- `HEYGEN_API_KEY` - Get from [HeyGen](https://heygen.com)
- `STREAM_API_KEY` and `STREAM_SECRET` - Get from [GetStream](https://getstream.io)
- `CARTESIA_API_KEY` - Get from [Cartesia](https://cartesia.ai)
- `DEEPGRAM_API_KEY` - Get from [Deepgram](https://deepgram.com)
- `GOOGLE_API_KEY` - Get from [Google AI Studio](https://makersuite.google.com/app/apikey)

## Running the Example

```bash
uv run avatar_example.py
```

This will:
1. Start an AI agent with a HeyGen avatar
2. Open a demo UI in your browser
3. The avatar will greet you and be ready to chat

## What's Happening

1. **Agent Setup**: The agent is configured with:
   - Gemini LLM for generating responses
   - Cartesia TTS for speech synthesis
   - Deepgram STT for speech recognition
   - HeyGen AvatarPublisher for avatar video

2. **Avatar Streaming**: When the agent speaks:
   - Text is generated by Gemini LLM
   - Audio is synthesized by Cartesia TTS
   - Audio is sent to HeyGen via WebRTC
   - HeyGen generates avatar video with lip-sync
   - Avatar video is streamed to the call

3. **User Interaction**: When you speak:
   - Audio is captured from your microphone
   - Transcribed to text by Deepgram
   - Sent to Gemini LLM for processing
   - Response is generated and spoken through the avatar

## Customization

### Using a Different Avatar

Get your avatar ID from HeyGen dashboard and update:

```python
heygen.AvatarPublisher(
    avatar_id="your_avatar_id_here",
    quality="high"
)
```

### Adjusting Video Quality

Choose quality based on your bandwidth:

```python
heygen.AvatarPublisher(
    avatar_id="default",
    quality="low",      # Options: "low", "medium", "high"
    resolution=(1280, 720)  # Lower resolution for better performance
)
```

### Using a Different LLM

Switch to OpenAI's Realtime API:

```python
from vision_agents.plugins import openai

agent = Agent(
    # ... other config ...
    llm=openai.Realtime(model="gpt-realtime", voice="alloy"),
    # No need for separate TTS/STT with Realtime LLM
    processors=[
        heygen.AvatarPublisher(avatar_id="default")
    ]
)
```

## Troubleshooting

### "HeyGen API key required" Error

Make sure `HEYGEN_API_KEY` is set in your `.env` file.

### Connection Timeout

- Check your internet connection
- Verify HeyGen API key is valid
- Ensure firewall allows WebRTC traffic

### No Video Appearing

- Check browser console for errors
- Verify GetStream credentials are correct
- Try lowering video quality settings

## Learn More

- [HeyGen API Documentation](https://docs.heygen.com/docs/streaming-api)
- [Vision Agents Documentation](https://visionagents.ai/)
- [GetStream Video Documentation](https://getstream.io/video/docs/)

